# Размещение в сети
https://github.com/Siblns/web-larek-frontend

# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Описание кода
Парадигма: MVP
Слой Модель, отвечает за вывод данных на страницу.
Слой Представления, отвечает за отображение данных на странице.
Слой Презентера реализован в основном файле проекта index.ts. Взаимодействие происходит за счет брокера событий, который их остлеживает.

1. Класс `ProductItem` объект- товар
состоит из:
  - id - ИД для использования в качестве просмотра продукта отдельно, удаления из     корзины, оформления заказа
  - title - Наименование продукта
  - description - Описание продукта
  - category - Категория продукта
  - image - Изображение продукта
  - price - Цена продукта

2. Класс `Page` отображает главную страницу проекта
состоит из: 
  - Лейбла Корзина и подсчета товаров в ней методом counter
  - Каталога товаров используя сеттер catalog, 
  - возмоности залокировать контент с помощью сеттера locked

3. Класс представление `Contact` включает в себя контакты покупателя 
Методы сеттер phone и email для получения и установки данных в разметку

4. Класс представление `Order` содержит дополнительную информацию о заказе
 Методы сеттер address и paymentMethod для получения и установки данных в разметку

Классы  `Page`, `Contact`,`Order`, `Page` содержат constructor(container: HTMLFormElement, events: IEvents) - DOM-элемент карточки на базе шаблона и объект с колбэком для вызова при клике.

6. Абстрактный класс `сardCompact` отвечает за реализацию карточки товара в сокращенном варианте.
Поля:
- _title - наименование
- _price - цена товара
- _button - кнопка для действия с карточкой
Методы set: title, price.
Методы get: title, price.

Класс `Card` строится на основе сardCompact и расширяет его засчет полей:
- category - категория товара
- image - изображение
- description - описание
Методы set: id, category, image, description, buttonText(изменение текста кнопки при добавллении в корзину)
Методы get: id(получение порядкового номера), category

Класс `cardBasket` строится на основе `сardCompact` с добавлением полей:
- _index - порядковый номер товара в корзине
- _deleteButton - добавление слушателя для удаления элемента
Метод set index - установка значения элементу.

`Card` и `cardBasket` содержат конструктор `constructor(container: HTMLElement, actions?: ICardActions)` - DOM-элемент карточки на базе шаблона и опционально объект с колбэком для вызова при клике.

7. Класс `Success`.
Отвечает за успешное выполнение заказа и дает возможность при клике на кнопку "За новыми покупками" вернуться в основное меню.
Класс Success имеет конструктор, который принимает два параметра: контейнер (элемент HTMLElement) и объект actions, содержащий возможные действия для компонента.В конструкторе происходит инициализация свойства _close, которое представляет собой элемент компонента, отвечающий за закрытие сообщения об успехе.
Содержит конструктор `constructor(container: HTMLElement, actions: ISuccessActions)` - DOM-элемент карточки на базе шаблона и опционально объект с колбэком для вызова при клике.

8. Класс `ProductAPI` - отвечает за работу с API
методы: 
 - getProductItem - Получение Товара
 - getProductList - Получение Списка Товаров
 - orderProducts - Получение Товаров находящихся в корзине

9. Класс `EventEmitter`
местоположение \src\components\base\events.ts
Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков
о наступлении события.
Класс имеет методы on ,  off ,  emit  — для подписки на событие, отписки от события и уведомления
подписчиков о наступлении события соответственно.
Дополнительно реализованы методы  onAll и  offAll  — для подписки на все события и сброса всех
подписчиков.

10. Абстрактный класс `Model` с обобщённым типом T. Он предназначен для создания моделей данных, которые могут уведомлять об изменениях через события.
Имеет конструктор, который принимает данные в виде объекта Partial<T> и объект IEvents представляющий собой интерфейс для работы с событиями. Внутри конструктора происходит копирование свойств из переданного объекта данных в текущий объект модели с помощью метода Object.assign().
Метод emitChanges() позволяет модели уведомить всех подписчиков о произошедших изменениях.

11. Абстрактный класс `Component` может быть использован для создания различных элементов пользовательского интерфейса. Имеет конструктор, принимающий единственный параметр — защищённый элемент HTMLElement (контейнер), в который будет производиться рендеринг компонента.
Методы и их назначение:
- setText - Установить текстовое содержимое
- toggleClass - Переключить класс
- setDisabled - Сменить статус блокировки
- setHidden - Скрыть 
- setVisible - Показать  
- setImage - Установить изображение с алтернативным текстом
- render - Вернуть корневой DOM-элемент

12. Класс `Api` дает возможность экземпляру выполненять запросы к серверу с помощью методов get() и post(), которые выполняют запросы к серверу.
Класс имеет два свойства: baseUrl — базовый URL, который будет использоваться при формировании запросов, и options — параметры запроса. 
В конструкторе происходит инициализация свойств baseUrl и options. В свойстве options задаются заголовки запроса, которые будут отправляться на сервер.
Метод handleResponse() обрабатывает ответ от сервера.

13. Класс `Basket` представляет собой компонент корзины для пользовательского интерфейса.
Класс Basket имеет конструктор, который принимает два параметра: контейнер (элемент HTMLElement) и объект EventEmitter для работы с событиями. Этот класс может быть использован для создания корзины в пользовательском интерфейсе и обработки событий, связанных с ней.
Сеттер методы items, price получают данные о корзине.
Элементы для отображения информации
- _list - Свойство items позволяет задать список товаров в корзине. Если список товаров пустой, то в элемент добавляется сообщение «Корзина пуста».
- _button - Начало оформления товаров. Если список выбранных товаров пустой, то кнопка _button становится неактивной.
- _price - Отображает общую сумму заказа.

14. Класс `Form` компонент формы для пользовательского интерфейса. Имеет конструктор, который принимает два параметра: контейнер (элемент HTMLFormElement) и объект IEvents для работы с событиями. При изменении полей формы срабатывает обработчик события input, который вызывает метод onInputChange с именем поля и его значением.При отправке формы срабатывает обработчик события submit, который предотвращает стандартное поведение формы (перезагрузку страницы) и вызывает метод emit объекта events с именем формы и событием submit
Методы:
- onInputChange - Вызывается при изменении полей формы с двумя параметрами: field (имя поля) и value (значение поля).
- сеттер valid - Проводит валижацию формы и устанавливает активность кнопки.
- сеттер errors - Свойство errors позволяет задать сообщение об ошибке.
- render - задает состояние формы. Метод вызывает метод render родительского класса, передавая свойства valid и errors. Затем метод копирует свойства inputs в текущий объект. Метод возвращает контейнер формы.

15. Класс `Modal` - компонент модального окна для пользовательского интерфейса.Класс Modal имеет конструктор, который принимает два параметра: контейнер (элемент HTMLElement) и объект IEvents для работы с событиями. В конструкторе происходит инициализация свойств _closeButton и _content, которые представляют собой элементы модального окна. Затем для элементов _closeButton и container добавляются обработчики события click, которые закрывают модальное окно. Для элемента _content добавляется обработчик события click, который останавливает распространение события.
Класс также содержит сеттер для свойства content, который позволяет задать содержимое модального окна. При установке нового значения содержимое элемента _content заменяется на переданный элемент.
Методы:
- open - Добавлет класс modal_active для октрытия окна
- close - Убирает класс у активного окна modal_active и уведомляет о том, что модальное окно закрыто, очищает модальное окно.
- render - Вызывает метод render родительского класса, передавая ему данные. Вызывает метод open, чтобы отобразить модальное окно. Возвращает контейнер модального окна.

16. Класс `AppState` - Отвечает за хранение данных и логику работы с ними. 
Поля:
- basket - информация о корзине, включая список товаров (items) и общую сумму (total).
- catalog - массив полученных товаров из каталога (ProductItem[]).
- order - объект с данными для оформления заказа включая email, телефон, адрес и способ оплаты.
- formErrors - объект для хранения ошибок формы
Методы:
- isInBasket - проверка товара в корзине
- addBasket - добавиление товара в корзину
- removeBasket - удаление из корзины
- clearBasket - очистка списка товаров корзины
- clearOrder - очистка доп информации корзины
- setCatalog - отображение полученных товаров
- setOrderField - изменение переданного поля на полученное значение
- validateOrder - проверка формы корзины на заполненность полей

# События приложения
- `items:change` - изменение товаров
- `basket:change` - изменение списка товаров корзины
- `formErrors:change` - изменение в списке ошибок валидации формы
- `modal:open` - открытие любого модального окна
- `modal:close` - закрытие любого модального окна
- `basket:open` - открытие модального окна корзины
- `order:open` - открытие окна оформления заказа
- `order:submit` - переход к заполнению контактов
- `contacts:submit` - подтвеждение заказа
- `order-button_alt:activ` - изменение способа оплаты
- `${form}.${field}:change` - изменение поля с кастомным названием в форме

# Список типов/интерфейсов
- `IProduct` - интерфейс со всеми свойствами продукта
- `IAppState` - интерфейс состояния приложения
- `IBasket` - интерфейс корзины с ее содержимым и общей стоимостью товаров в ней
- `IOrderForm` - интерфейс доп. информции по заказу
- `IProductAPI` - интерфейс для работы с апи
- `IPage` - интерфейс свойства страницы
- `ApiPostMethods` - тип - методы работы с апи
- `IOrderFull` - объединеный интерфейс заказа для отправки на сервер
- `TContactBasket` - тип формы контактов
- `TOrderInput` - тип формы заказа
- `IOrderResult` - интерфейс результата отправки заказа
- `FormErrors` - тип для формы ошибок
- `CatalogChangeEvent` - содержит массив товаров